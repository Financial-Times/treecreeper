name: Repository
pluralName: Repositories
description: |
  A source code repository. Should generally not be manually created as we have a
  cron job that regularly syncs from github and bitbucket to Biz Ops
createPermissions:
  - biz-ops-github-importer
properties:
  code:
    type: Code
    required: true
    unique: true
    pattern: REPO_NAME # can't find any published rules on github repo names, so must be loose
    canIdentify: true
    isCore: true
    label: Code
    fieldset: general
    description: |
        Unique code for this repository. Automatically created, it is a combination
        of the type of system the repository is stored in e.g. github, bitbucket,
        and that system's id for the repository.
  name:
    type: Name
    isCore: true
    label: Name
    fieldset: general
    description: Display name for the repository, taken from the system it is stored in.
  description:
    type: Paragraph
    label: Description
    fieldset: general
    description: Description of what is in the repository, taken from the system it is stored in.
  url:
    type: Url
    # required: true
    canIdentify: true
    isCore: true
    label: URL
    fieldset: general
    description: Web page URL for the repository.
  systems:
    type: System
    direction: incoming
    label: Systems
    fieldset: general
    relationship: HAS_REPO
    description: Systems which the repository holds source code for.
    hasMany: true
  versionControlSystem:
    type: VersionControlSystem
    label: Version control system
    fieldset: general
    description: Version control system the repository is stored in.
  lastSeenInSynk:
    type: Date
    label: Last Seen In Snyk
    description: The date on which this repository was last listed in Synk as being actively scanned for vulnerabilities.
    fieldset: general
    deprecationReason: typo in field name
  lastSeenInSnyk:
    type: Date
    label: Last seen in Snyk
    description: The date on which this repository was last listed in Snyk as being actively scanned for vulnerabilities.
    fieldset: general
  isPrivate:
    type: Boolean
    isCore: true
    label: Private
    description: Is the repository private.
    fieldset: technical
  isArchived:
    type: Boolean
    isCore: true
    label: Archived
    description: Is the repository archived.
    fieldset: technical
  vcsID:
    type: Word
    label: VCS ID
    description: The internal ID for the repository in the version control system that it's stored in.
    fieldset: technical
  sshUrl:
    type: Url
    # required: true
    canIdentify: true
    label: SSH URL
    description: SSH URL to checkout the source.
    fieldset: technical
  createdAt:
    type: DateTime
    label: Created
    description: The timestamp when the repository was created.
    fieldset: technical
  pushedAt:
    type: DateTime
    label: Updated
    description: The timestamp when the repository was last pushed to.
    fieldset: technical
  projectName:
    type: Word
    label: Project name
    description: The repository's project name (FT Bitbucket repositories only).
    fieldset: technical
  projectUrl:
    type: Url
    label: Project URL
    description: The URL of the repository's project (FT Bitbucket repositories only).
    fieldset: technical

  storedIn:
    type: System
    direction: outgoing
    label: Stored in
    deprecationReason: The storedIn relationship is now replaced by the versionControlSystem property
    relationship: STORED_IN
    description: VCS provider that the repository is hosted by.

fieldsets:
  general:
    heading: General information
  technical:
    heading: Technical details
