name: CookieInstance
description: |
  A node with cookie relationship data specific to a cookie attached to a domain/product website. Data includes cookie path and last seen date.
createPermissions:
  - ip-cookie-audit
rank: 100
properties:
  code:
    type: Code
    label: Code
    description: Unique code for this record, an amalgamation of the cookie name and domain it's found on.
    canIdentify: true
    required: true
    unique: true
    pattern: MAX_LENGTH_64
    fieldset: main

  path:
    type: Word
    label: Path
    description: The path the cookie is set on.
    required: true

  lastSeen:
    type: Date
    label: Date last seen
    description: Date Cookie last found during audit of product / website Audit.
    required: true

  product:
    type: Word
    label: Product
    description: The product / website the cookie is found on.
    required: true
    isCore: true

  expiry:
    type: CookieExpiry
    label: Session or Persistent Cookie
    description: |
      Information taken from cookie audit confirming if cookie found as a session or persistent cookie at time of last audit.
    required: true
    isCore: true
    fieldset: main

  isInstanceOfCookie:
    type: Cookie
    label: Cookie details
    relationship: IS_SET_AS
    description: Information about what the cookie is for, taken from cookiepedia.
    direction: incoming

fieldsets:
  main:
    heading: Main properties
    description: These are all essential to fill out.
